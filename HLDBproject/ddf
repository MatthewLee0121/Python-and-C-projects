import sqlite3
import random
from faker import Faker
import os

# Initialize Faker and the SQLite connection
fake = Faker()
# Set up the database connection
db_path = os.path.join(os.path.dirname(os.path.abspath(__file__)), 'HLDB.db')
conn = sqlite3.connect(db_path)

cursor = conn.cursor()

# Define some possible column types
column_types = ["TEXT", "INTEGER", "REAL"]

# Function to generate random column names and types
def generate_columns():
    num_columns = random.randint(3, 6)  # 3 to 6 columns per table
    columns = {}
    for i in range(num_columns):
        column_name = f"column_{i+1}"
        column_type = random.choice(column_types)
        columns[column_name] = column_type
    return columns

# Function to generate random data for a row
def generate_row(columns):
    row = []
    for column_type in columns.values():
        if column_type == "TEXT":
            row.append(f"'{fake.word()}'")
        elif column_type == "INTEGER":
            row.append(str(random.randint(1, 1000)))
        elif column_type == "REAL":
            row.append(str(round(random.uniform(1, 1000), 2)))
    return row

# Create 10 tables with random data
for table_num in range(10):
    # Generate a random table name
    table_name = f"table_{table_num+1}"
    
    # Generate random columns
    columns = generate_columns()
    
    # Create the table SQL statement
    columns_sql = ", ".join(f"{name} {col_type}" for name, col_type in columns.items())
    create_table_sql = f"CREATE TABLE IF NOT EXISTS {table_name} ({columns_sql});"
    cursor.execute(create_table_sql)
    
    # Insert more than 20 rows of random data
    for _ in range(25):  # 25 rows per table
        row_data = generate_row(columns)
        insert_sql = f"INSERT INTO {table_name} VALUES ({', '.join(row_data)});"
        cursor.execute(insert_sql)

# Commit the changes and close the connection
conn.commit()
conn.close()

print("10 random tables with random data have been created.")
